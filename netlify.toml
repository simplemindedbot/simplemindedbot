[build]
publish = "public"
command = "npm run abridge -- '--base-url https://simpleminded.bot'"
functions = "netlify/functions"

[build.environment]
ZOLA_VERSION = "0.19.2"
NODE_VERSION = "22.9.0"

[context.deploy-preview]
command = "npm run abridge -- '--drafts --base-url https://simpleminded.bot'"

[[plugins]]
  package = "@netlify/plugin-csp-nonce"
  [plugins.inputs]
  reportOnly = true
  excludedPath = [
    "/api/*",
    "**/*.bespoke.extension"
  ]

[[plugins]]
  package = "netlify-plugin-submit-sitemap"

	[plugins.inputs]

	# The base url of your site (optional, default = main URL set in Netlify)
	baseUrl = "https://simpleminded.bot"

	# Path to the sitemap URL (optional, default = /sitemap.xml)
	sitemapPath = "/sitemap.xml"

	# Time in seconds to not submit the sitemap after successful submission
	ignorePeriod = 0

	# Enabled providers to submit sitemap to (optional, default = 'google', 'yandex'). Possible providers are currently only 'google', 'yandex'.
	providers = [
		"google",
		"yandex"
	]

[functions]
  node_bundler = "esbuild"

[[headers]]
  for = "/*"
  [headers.values]
    Content-Security-Policy = "default-src 'self'; script-src 'self' 'unsafe-inline' 'nonce-{{nonce}}' ajax.cloudflare.com static.cloudflareinsights.com www.google.com/recaptcha/ www.gstatic.com/recaptcha/; style-src 'self' 'unsafe-inline' 'nonce-{{nonce}}' fonts.googleapis.com; font-src 'self' fonts.gstatic.com; img-src 'self' data:; connect-src 'self' *.cloudflare.com; media-src 'self'; object-src 'none'; frame-src 'self' www.google.com/recaptcha/; worker-src 'self'; form-action 'self' https://api.netlify.com; frame-ancestors 'none'; base-uri 'self'; manifest-src 'self'; child-src 'self'; upgrade-insecure-requests;"
